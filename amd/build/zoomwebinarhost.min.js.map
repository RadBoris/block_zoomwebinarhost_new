{"version":3,"sources":["../src/zoomwebinarhost.js"],"names":["define","$","log","fragment","templates","ajax","init","courseid","contextid","document","ready","defaultValue","val","border","css","click","event","preventDefault","stopPropagation","email","trim","validate","test","toLowerCase","length","alert","params","promise","call","methodname","args","then","loadFragment","done","html","js","M","core_formchangechecker","reset_form_dirty_state","replaceNodeContents","location","reload","catch","error","message","console","e","host","target","id","hostid","split","email_to_delete","innerText","promise1","focus"],"mappings":"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","sourcesContent":["define(['jquery', 'core/log', 'core/fragment', 'core/templates', 'core/ajax'], function($, log, fragment, templates, ajax) {\n\n    return {\n        init: function(courseid, contextid) {\n\n            $(document).ready(function() {\n\n                const defaultValue = $('[name=\"email\"]').val();\n\n                const border = () => {\n                    $(\"input[name='email']\").css({\n                    'border-color': 'red'\n                   });\n                }\n\n                $('#id_add').click((event) => {\n                    event.preventDefault();\n                    event.stopPropagation();\n\n                    const email = $(\"input[name='email']\").val().trim();\n                    const validate = (email) => {\n                        const expression = /(?!.*\\.{2})^([a-z\\d!#$%&'*+\\-\\/=?^_`{|}~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+(\\.[a-z\\d!#$%&'*+\\-\\/=?^_`{|}~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+)*|\"((([ \\t]*\\r\\n)?[ \\t]+)?([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f\\x21\\x23-\\x5b\\x5d-\\x7e\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))*(([ \\t]*\\r\\n)?[ \\t]+)?\")@(([a-z\\d\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|[a-z\\d\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF][a-z\\d\\-._~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]*[a-z\\d\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])\\.)+([a-z\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|[a-z\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF][a-z\\d\\-._~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]*[a-z\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])\\.?$/i;\n                        return expression.test(String(email).toLowerCase()) && String(email).length;\n                    }\n                    if (!validate(email)) {\n                        border();\n                        alert('Invalid email');\n                        return;\n                    }\n\n                    const params = {\n                        courseid: courseid,\n                        email: email\n                    };\n\n                    var promise = ajax.call([{\n                        methodname: 'block_zoomwebinarhost_create_webinar_host',\n                        args: {\n                            courseid: courseid,\n                            email: email\n                        }\n                    }]);\n\n                    promise[0].then((response) => {\n                        fragment.loadFragment('block_zoomwebinarhost', 'formreload', contextid, params).done(function(html, js) {\n                            M.core_formchangechecker.reset_form_dirty_state();\n                            templates.replaceNodeContents($('.mform'), html, js);\n                            document.location.reload();\n                        })\n                    }).catch((error) => {\n                        border();\n                        alert(error.message);\n                        console.log(error.message);\n                        return;\n                    })\n                });\n\n                $('[id*=\"id_delete\"]').click((e) => {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    const host = e.target.id;\n                    const hostid = host.split(/\\_(?=[^\\_]+$)/)[1];\n\n                    const email_to_delete = $('#fitem_id_host_' + hostid)[0].innerText.trim();\n                    const params = {\n                        courseid: courseid,\n                        email: email_to_delete\n                    };\n\n\n                    var promise1 = ajax.call([{\n                        methodname: 'block_zoomwebinarhost_delete_webinar_host',\n                        args: {\n                            courseid: courseid,\n                            email: email_to_delete\n                        }\n                    }]);\n\n                    promise1[0].then((response) => {\n                        fragment.loadFragment('block_zoomwebinarhost', 'formreload', contextid, params).then(function(html, js) {\n                            templates.replaceNodeContents($('.mform'), html, js)\n                        });\n                        document.location.reload();\n                    }).catch((error) => {\n                        console.log(error);\n                    })\n                });\n\n                $('#id_email').focus((e) => {\n                    $(e.target).val('').css({\n                        'border-color': ''\n                    });\n                });\n\n            });\n        }\n    };\n});"],"file":"zoomwebinarhost.min.js"}